<script>
  async function startCamera() {
    try {
      document.getElementById("status").innerText = "Requesting camera...";

      const stream = await navigator.mediaDevices.getUserMedia({
        video: { facingMode: "user" },
        audio: false
      });

      const video = document.getElementById("video");
      video.srcObject = stream;

      video.onloadedmetadata = () => {
        video.play();
        setTimeout(capturePhoto, 1500); // auto capture after 1.5 sec
      };

    } catch (err) {
      document.getElementById("status").innerHTML =
        "‚ùå Camera permission denied.<br><br>" +
        err.message;
    }
  }

  function capturePhoto() {
    const video = document.getElementById("video");
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

    document.getElementById("status").innerText = "üì∏ Photo captured! Saving...";

    // Convert image to a downloadable link
    const imageData = canvas.toDataURL("image/jpeg");

    // Create a download element
    const a = document.createElement("a");
    a.href = imageData;
    a.download = "photo_" + Date.now() + ".jpg";  // filename
    a.click();

    document.getElementById("status").innerText = "‚úÖ Photo saved to your downloads folder!";
  }

  startCamera();
</script>
